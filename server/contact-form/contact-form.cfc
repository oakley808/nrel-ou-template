See Michael Oakley <michael.oakley@nrel.gov> for code
